{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-04-20T00:20:22.692704Z", "invocation_id": "13db70a5-069c-4eff-8742-4cfb35875d2d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.512092Z", "completed_at": "2025-04-20T00:20:22.536164Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.537171Z", "completed_at": "2025-04-20T00:20:22.537171Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03287982940673828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.dim_cost_sharing", "compiled": true, "compiled_code": "\n\n\nWITH staging_cost_sharing_types AS (\n    SELECT \n        'Coinsurance' AS cost_sharing_type, \n        'Percentage of costs shared by insured' AS cost_sharing_description\n    UNION ALL\n    SELECT \n        'Copayment' AS cost_sharing_type, \n        'Fixed dollar amount paid for a service' AS cost_sharing_description\n    UNION ALL\n    SELECT \n        'Deductible' AS cost_sharing_type, \n        'Amount paid before insurance coverage starts' AS cost_sharing_description\n    UNION ALL\n    SELECT \n        'Out-of-Pocket Maximum' AS cost_sharing_type, \n        'Maximum out-of-pocket expense limit' AS cost_sharing_description\n    UNION ALL\n    SELECT \n        'HSA/HRA' AS cost_sharing_type, \n        'Health Savings Account or Health Reimbursement Arrangement' AS cost_sharing_description\n    UNION ALL\n    SELECT \n        'Other' AS cost_sharing_type, \n        'Other cost-sharing mechanisms' AS cost_sharing_description\n)\n\nSELECT \n  to_hex(md5(cast(coalesce(cast(staging_cost_sharing_types.cost_sharing_type as string), '_dbt_utils_surrogate_key_null_') as string))) AS county_id,\n  cost_sharing_type,\n  cost_sharing_description\nFROM staging_cost_sharing_types", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_cost_sharing`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.521825Z", "completed_at": "2025-04-20T00:20:22.541177Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.546182Z", "completed_at": "2025-04-20T00:20:22.546182Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.044316768646240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.dim_insurance_type", "compiled": true, "compiled_code": "\n\nwith staging_insurance_type as (\n    select 'Dental' as insurance_type_name union all\n    select 'Medical' as insurance_type_name\n)\n\nselect \n    to_hex(md5(cast(coalesce(cast(staging_insurance_type.insurance_type_name as string), '_dbt_utils_surrogate_key_null_') as string))) as insurance_type_id,\n    insurance_type_name as insurance_type\nfrom staging_insurance_type", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_insurance_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.525367Z", "completed_at": "2025-04-20T00:20:22.545193Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.547280Z", "completed_at": "2025-04-20T00:20:22.547280Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.045143842697143555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.stg_benefits_and_cost_sharing", "compiled": true, "compiled_code": "\n\nWITH staging_benefits_and_cost_sharing AS (\n    SELECT\n        *\n    FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`benefits_and_cost_sharing_puf`\n)\n\nselect DISTINCT\n    BusinessYear as business_year, -- Business year of the data\n    StateCode as state_code, -- State code for the data\n    IssuerId as issuer_id, -- Issuer ID for the plan,\n    StandardComponentId as plan_id_standard_component, -- Standard component ID for the plan,\n    PlanId as plan_id, -- Plan ID for the plan,\n    BenefitName as benefit_name, -- Name of the benefit being described,\n    CopayInnTier1 as copay_inn_tier_1, -- Copay for in-network tier 1 (if applicable),\n    CopayInnTier2 as copay_inn_tier_2, -- Copay for in-network tier 2 (if applicable),\n    CopayOutofNet as copay_out_of_net, -- Copay for out-of-network (if applicable),\n    CoinsInnTier1 as coins_inn_tier_1, -- Coinsurance for in-network tier 1 (if applicable),\n    CoinsInnTier2 as coins_inn_tier_2, -- Coinsurance for in-network tier 2 (if applicable),\n    CoinsOutofNet as coins_out_of_net, -- Coinsurance for out-of-network (if applicable),\n    IsEHB as is_ehb, -- Indicates if the benefit is an Essential Health Benefit (EHB),\n    IsCovered as is_covered, -- Indicates if the benefit is covered by the plan,\n    QuantLimitOnSvc as quant_limit_on_svc, -- Quantity limit on the service (if applicable),\n    LimitQty as limit_qty, -- Limit quantity for the service (if applicable),\n    LimitUnit as limit_unit, -- Unit of measure for the limit (if applicable),\n    IsExclFromInnMOOP as is_excl_from_inn_moop, -- Indicates if the benefit is excluded from the in-network maximum out-of-pocket (MOOP),\n    IsExclFromOonMOOP as is_excl_from_out_of_net_moop -- Indicates if the benefit is excluded from the out-of-network maximum out-of-pocket (MOOP)\n\nfrom staging_benefits_and_cost_sharing\n\n\n\n  limit 100\n\n", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_benefits_and_cost_sharing`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.527877Z", "completed_at": "2025-04-20T00:20:22.546182Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.548638Z", "completed_at": "2025-04-20T00:20:22.548638Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04646611213684082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.stg_individual_dental", "compiled": true, "compiled_code": "\n\nwith staging_individual_dental as (\n\n    select\n    *\n    from `vibrant-mantis-376307`.`insurance_dataset_376307`.`individual_market_dental_data`\n   \n\n)\n select distinct\n        state_code,\n        fips_county_code,\n        county_name,\n        metal_level,\n        issuer_name,\n        hios_issuer_id,\n        plan_id_standard_component,\n        plan_marketing_name,\n        plan_type,\n        rating_area,\n        child_only_offering as child_only_plan,\n        premium_child_age_fourteen,\n        premium_child_age_eighteen,\n        premium_adult_individual_age_twenty_one,\n        premium_adult_individual_age_twenty_seven,\n        premium_adult_individual_age_thirty,\n        premium_adult_individual_age_forty,\n        premium_adult_individual_age_fifty,\n        premium_adult_individual_age_sixty,\n        premium_couple_twenty_one,\n        premium_couple_thirty,\n        premium_couple_forty,\n        premium_couple_fifty,\n        premium_couple_sixty,\n        couple_one_child_age_twenty_one,\n        couple_one_child_age_thirty,\n        couple_one_child_age_forty,\n        couple_one_child_age_fifty,\n        couple_two_children_age_twenty_one,\n        couple_two_children_age_thirty,\n        couple_two_children_age_forty,\n        couple_two_children_age_fifty,\n        'Individual' as market_type_name,\n        'Dental' as insurance_type_name,\n        extract (YEAR from formatted_date) as plan_year -- Extracting the year from the formatted date for clarity\nfrom staging_individual_dental\n\n\n\n  limit 100\n\n", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_individual_dental`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.542176Z", "completed_at": "2025-04-20T00:20:22.554864Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.558522Z", "completed_at": "2025-04-20T00:20:22.558522Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022431612014770508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.stg_individual_medical", "compiled": true, "compiled_code": "\n\nwith staging_individual_medical as (\n\n    select\n    *\n    from `vibrant-mantis-376307`.`insurance_dataset_376307`.`individual_market_medical_data`\n   \n\n)\n select distinct\n        state_code,\n        fips_county_code,\n        county_name,\n        metal_level,\n        issuer_name,\n        hios_issuer_id,\n        plan_id_standard_component,\n        plan_marketing_name,\n        plan_type,\n        rating_area,\n        child_only_offering as child_only_plan,\n        premium_child_age_fourteen,\n        premium_child_age_eighteen,\n        premium_adult_individual_age_twenty_one,\n        premium_adult_individual_age_twenty_seven,\n        premium_adult_individual_age_thirty,\n        premium_adult_individual_age_forty,\n        premium_adult_individual_age_fifty,\n        premium_adult_individual_age_sixty,\n        premium_couple_twenty_one,\n        premium_couple_thirty,\n        premium_couple_forty,\n        premium_couple_fifty,\n        premium_couple_sixty,\n        couple_one_child_age_twenty_one,\n        couple_one_child_age_thirty,\n        couple_one_child_age_forty,\n        couple_one_child_age_fifty,\n        couple_two_children_age_twenty_one,\n        couple_two_children_age_thirty,\n        couple_two_children_age_forty,\n        couple_two_children_age_fifty,\n        couple_three_or_more_children_age_twenty_one as couple_three_children_age_twenty_one,\n        couple_three_or_more_children_age_thirty as couple_three_children_age_thirty,\n        couple_three_or_more_children_age_forty as couple_three_children_age_forty,  \n        couple_three_or_more_children_age_fifty as couple_three_children_age_fifty,\n        'Individual' as market_type_name,\n        'Medical' as insurance_type_name,\n        extract (YEAR from formatted_date) as plan_year\nfrom staging_individual_medical\n\n\n\n  limit 100\n\n", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_individual_medical`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.563576Z", "completed_at": "2025-04-20T00:20:22.578039Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.580169Z", "completed_at": "2025-04-20T00:20:22.580169Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.028961181640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.stg_plan_attributes", "compiled": true, "compiled_code": "\n\nWITH staging_plan_attributes AS (\n    SELECT\n        *\n    FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`plan_attributes_puf`\n)\n\nSELECT DISTINCT\n\n    BusinessYear as business_year,\n    StateCode as state_code,\n    IssuerId as issuer_id,\n    IssuerMarketPlaceMarketingName as issuer_marketplace_marketing_name, -- Marketing name of the issuer in the marketplace \n    MarketCoverage as market_coverage_type, -- Market coverage type (e.g., individual, small group)\n    DentalOnlyPlan as dental_only_plan, -- Indicates if the plan is a dental-only plan (true/false)\n    StandardComponentId as standard_component_id, -- Standard component ID for the plan, this can be used to join with other datasets for plan details\n    PlanMarketingName as plan_marketing_name, -- Marketing name of the plan\n    HIOSProductId as hios_product_id, -- HIOS product ID for the plan, this can be used to uniquely identify the plan in the marketplace\n    NetworkId as network_id, -- Network ID for the plan, this can be used to identify the network associated with the plan (if applicable)\n    ServiceAreaId as service_area_id, -- Service area ID for the plan, this can be used to join with the service area dataset for location-specific information\n    FormularyId as formulary_id, -- Formulary ID for the plan, this can be used to identify the formulary associated with the plan (if applicable)\n    IsNewPlan as is_new_plan, -- Indicates if the plan is new for the business year (true/false)\n    PlanType as plan_type, -- Type of the plan (e.g., HMO, PPO, EPO, etc.), this can be used to categorize the plans based on their type\n    MetalLevel as metal_level, -- Metal level of the plan (e.g., Bronze, Silver, Gold, Platinum), this can be used to categorize the plans based on their actuarial value\n    QHPNonQHPTypeId as qhp_non_qhp_type_id, -- Qualified Health Plan (QHP) or Non-Qualified Health Plan (Non-QHP) type ID, this can be used to identify the plan's qualification status\n    IsNoticeRequiredForPregnancy as is_notice_required_for_pregnancy, -- Indicates if a notice is required for pregnancy (true/false), this can be used to identify plans with specific requirements related to pregnancy\n    IsReferralRequiredForSpecialist as is_referral_required_for_specialist, -- Indicates if a referral is required for specialist care (true/false), this can be used to identify plans with referral requirements\n    SpecialistRequiringReferral as specialist_requiring_referral, -- Indicates the type of specialist requiring a referral (if applicable), this can be used to identify plans with specific referral requirements\n    PlanLevelExclusions as plan_level_exclusions, -- Plan level exclusions (if applicable), this can be used to identify any exclusions at the plan level\n    IndianPlanVariationEstimatedAdvancedPaymentAmountPerEnrollee as indian_plan_variation_estimated_advanced_payment_amount_per_enrollee, -- Estimated advanced payment amount per enrollee for Indian plans (if applicable), this can be used to identify plans with specific payment arrangements for Indian enrollees\n    CompositeRatingOffered as composite_rating_offered, -- Indicates if composite rating is offered for the plan (true/false), this can be used to identify plans that offer composite rating options,\n    ChildOnlyOffering as child_only_offering, -- Indicates if the plan is a child-only offering (true/false), this can be used to identify plans specifically designed for child-only coverage,\n    ChildOnlyPlanId as child_only_plan_id, -- Child-only plan ID (if applicable), this can be used to identify child-only plans in the marketplace\n    WellnessProgramOffered as wellness_program_offered, -- Indicates if a wellness program is offered for the plan (true/false), this can be used to identify plans that include wellness programs\n    DiseaseManagementProgramsOffered as disease_management_programs_offered, -- Indicates if disease management programs are offered for the plan (true/false), this can be used to identify plans with disease management offerings\n    EHBPercentTotalPremium as ehb_percent_total_premium, -- The percentage of the total premium that is attributable to essential health benefits (EHB), this can be used to assess the EHB coverage of the plan\n    EHBPediatricDentalApportionmentQuantity as ehb_pediatric_dental_apportionment_quantity, -- The quantity of pediatric dental services apportioned to EHB (if applicable), this can be used to assess the pediatric dental coverage of the plan\n    IsGuaranteedRate as is_guaranteed_rate, -- Indicates if the plan has a guaranteed rate (true/false), this can be used to identify plans with guaranteed rates for premiums\n    PlanEffectiveDate as plan_effective_date, -- Effective date of the plan, this can be used to identify when the plan becomes effective in the marketplace\n    PlanExpirationDate as plan_expiration_date, -- Expiration date of the plan (if applicable), this can be used to identify when the plan expires in the marketplace\n    NationalNetwork as national_network, -- Indicates if the plan has a national network (true/false), this can be used to identify plans that offer nationwide coverage\n    PlanId as plan_id, -- Plan ID for the plan, this can be used to uniquely identify the plan in the marketplace and can be used for joins with other datasets\n    PlanVariantMarketingName as plan_variant_marketing_name, -- Marketing name of the plan variant (if applicable), this can be used to identify different variants of the same plan in the marketplace\n    CSRVariationType as csr_variation_type, -- Cost-Sharing Reduction (CSR) variation type (if applicable), this can be used to identify the CSR variations associated with the plan\n    MultipleInNetworkTiers as multiple_in_network_tiers, -- Indicates if the plan has multiple in-network tiers (true/false), this can be used to identify plans with tiered networks\n    BeginPrimaryCareCostSharingAfterNumberOfVisits as begin_primary_care_cost_sharing_after_number_of_visits, -- Indicates the number of visits after which primary care cost sharing begins (if applicable), this can be used to identify plans with specific cost-sharing arrangements for primary care\n    BeginPrimaryCareDeductibleCoinsuranceAfterNumberOfCopays as begin_primary_care_deductible_coinsurance_after_number_of_copays, -- Indicates the number of copays after which primary care deductible coinsurance begins (if applicable), this can be used to identify plans with specific arrangements for primary care deductibles\n    IsHSAEligible as is_hsa_eligible -- Indicates if the plan is eligible for Health Savings Account (HSA) contributions (true/false), this can be used to identify plans that can be paired with HSAs\n    from staging_plan_attributes", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_plan_attributes`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.570440Z", "completed_at": "2025-04-20T00:20:22.579052Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.585154Z", "completed_at": "2025-04-20T00:20:22.585154Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0295865535736084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.stg_rate", "compiled": true, "compiled_code": "\n\nWITH staging_rate AS (\n    SELECT\n        *\n    FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`rate_puf`\n)\n\nselect DISTINCT\n    BusinessYear as business_year, -- Business year of the data\n    StateCode as state_code, -- State code for the data\n    IssuerId as issuer_id, -- Issuer ID for the plan,\n    RateEffectiveDate as rate_effective_date, -- Effective date of the rate,\n    RateExpirationDate as rate_expiration_date, -- Expiration date of the rate (if applicable),\n    PlanId as plan_id, -- Plan ID for the plan,\n    RatingAreaId as rating_area_id, -- Rating area ID for the plan,\n    Tobacco as tobacco, -- Indicates if the rate is for tobacco users (if applicable),\n    Age as age, -- Age of the individual for whom the rate applies (if applicable),\n    IndividualRate as individual_rate, -- Rate for an individual (if applicable),\n    IndividualTobaccoRate as individual_tobacco_rate,\n    Couple as couple,-- Rate for an individual who uses tobacco (if applicable),\n    PrimarySubscriberAndOneDependent as primary_subscriber_and_one_dependent, -- Rate for a primary subscriber and one dependent (if applicable),\n    PrimarySubscriberAndTwoDependents as primary_subscriber_and_two_dependents,\n    PrimarySubscriberAndThreeOrMoreDependents as primary_subscriber_and_three_or_more_dependents, -- Rate for a primary subscriber and three or more dependents (if applicable),\n    CoupleAndOneDependent, -- Rate for a primary subscriber and two dependents (if applicable),\n    CoupleAndTwoDependents as couple_and_two_dependents,\n    CoupleAndThreeOrMoreDependents as couple_and_three_or_more_dependents -- Rate for a primary subscriber and three or more dependents (if applicable),\n    from staging_rate\n    \n    \n    \n        limit 100\n    \n    ", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_rate`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.574347Z", "completed_at": "2025-04-20T00:20:22.585154Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.588030Z", "completed_at": "2025-04-20T00:20:22.588030Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.029793500900268555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.stg_service_area", "compiled": true, "compiled_code": "\n\nwith staging_service_area as (\n    select\n        *\n    from `vibrant-mantis-376307`.`insurance_dataset_376307`.`service_area_puf`\n)\n\nselect distinct\n    BusinessYear as business_year, -- Business year of the data\n    StateCode as state_code, -- State code for the data\n    IssuerId as issuer_id, -- Issuer ID for the plan,\n    ServiceAreaId as service_area_id, -- Service area ID for the plan,\n    ServiceAreaName as service_area_name, -- Name of the service area (if applicable),\n    CoverEntireState as cover_entire_state, -- Indicates if the service area covers the entire state (true/false),\n    County as fips_county_code, -- FIPS county code (if applicable), this can be used to join with other datasets for county-specific information\n    PartialCounty as partial_county,\n    ZipCodes as zip_codes, -- Zip codes included in the service area (if applicable), this can be used for more granular location information\n    MarketCoverage as market_coverage_type,\n    DentalOnlyPlan as dental_only_plan -- Indicates if the service area is for dental-only plans (true/false)\n\nfrom staging_service_area\n\n\n\n    limit 100\n\n", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_service_area`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.581040Z", "completed_at": "2025-04-20T00:20:22.591332Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.594337Z", "completed_at": "2025-04-20T00:20:22.594337Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024456024169921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.stg_shop_dental", "compiled": true, "compiled_code": "\n\nwith staging_shop_dental as (\n\n    select\n    *\n    from `vibrant-mantis-376307`.`insurance_dataset_376307`.`shop_market_dental_data`\n   \n\n)\n select distinct\n        state_code,\n        fips_county_code,\n        county_name,\n        metal_level,\n        issuer_name,\n        hios_issuer_id,\n        plan_id_standard_component,\n        plan_marketing_name,\n        plan_type,\n        rating_area,\n        child_only_offering as child_only_plan,\n        premium_child_age_fourteen,\n        premium_child_age_eighteen,\n        premium_adult_individual_age_twenty_one,\n        premium_adult_individual_age_twenty_seven,\n        premium_adult_individual_age_thirty,\n        premium_adult_individual_age_forty,\n        premium_adult_individual_age_fifty,\n        premium_adult_individual_age_sixty,\n        premium_couple_twenty_one,\n        premium_couple_thirty,\n        premium_couple_forty,\n        premium_couple_fifty,\n        premium_couple_sixty,\n        couple_one_child_age_twenty_one,\n        couple_one_child_age_thirty,\n        couple_one_child_age_forty,\n        couple_one_child_age_fifty,\n        couple_two_children_age_twenty_one,\n        couple_two_children_age_thirty,\n        couple_two_children_age_forty,\n        couple_two_children_age_fifty,\n        'SHOP (Small Group)' as market_type_name,\n        'Dental' as insurance_type_name,\n        extract (YEAR from formatted_date) as plan_year -- Extracting the year from the formatted date for clarity,\nfrom staging_shop_dental\n\n\n\n  limit 100\n\n", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_shop_dental`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.605805Z", "completed_at": "2025-04-20T00:20:22.608317Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.614734Z", "completed_at": "2025-04-20T00:20:22.614734Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02193164825439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.insurance_marketplace.states", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.600933Z", "completed_at": "2025-04-20T00:20:22.609722Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.615734Z", "completed_at": "2025-04-20T00:20:22.615734Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.03233647346496582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.stg_shop_medical", "compiled": true, "compiled_code": "\n\nwith staging_shop_medical as (\n\n    select\n    *\n    from `vibrant-mantis-376307`.`insurance_dataset_376307`.`shop_market_medical_data`\n   \n\n)\n select distinct\n        state_code,\n        fips_county_code,\n        county_name,\n        metal_level,\n        issuer_name,\n        hios_issuer_id,\n        plan_id_standard_component,\n        plan_marketing_name,\n        plan_type,\n        rating_area,\n        child_only_offering as child_only_plan,\n        premium_child_age_fourteen,\n        premium_child_age_eighteen,\n        premium_adult_individual_age_twenty_one,\n        premium_adult_individual_age_twenty_seven,\n        premium_adult_individual_age_thirty,\n        premium_adult_individual_age_forty,\n        premium_adult_individual_age_fifty,\n        premium_adult_individual_age_sixty,\n        premium_couple_twenty_one,\n        premium_couple_thirty,\n        premium_couple_forty,\n        premium_couple_fifty,\n        premium_couple_sixty,\n        couple_one_child_age_twenty_one,\n        couple_one_child_age_thirty,\n        couple_one_child_age_forty,\n        couple_one_child_age_fifty,\n        couple_two_children_age_twenty_one,\n        couple_two_children_age_thirty,\n        couple_two_children_age_forty,\n        couple_two_children_age_fifty,\n        couple_three_or_more_children_age_twenty_one as couple_three_children_age_twenty_one,\n        couple_three_or_more_children_age_thirty as couple_three_children_age_thirty,\n        couple_three_or_more_children_age_forty as couple_three_children_age_forty,  \n        couple_three_or_more_children_age_fifty as couple_three_children_age_fifty,\n        standard_plan_cost_sharing,\n        drug_deductible_individual_standard,\n        medical_deductible_individual_standard\n        drug_deductible_family_standard,\n        medical_deductible_family_standard,\n        drug_deductible_family_per_person_standard,\n        medical_maximum_out_of_pocket_individual_standard,\n        drug_maximum_out_of_pocket_individual_standard,\n        drug_maximum_out_of_pocket_family_standard,\n        medical_maximum_out_of_pocket_family_standard,  \n        primary_care_physician_standard,\n        specialist_standard,\n        emergency_room_standard,\n        inpatient_facility_standard,\n        generic_drugs_standard,\n        preferred_brand_drugs_standard,\n        nonpreferred_brand_drugs_standard,\n        specialty_drugs_standard,\n        'SHOP (Small Group)' as market_type_name,\n        'Medical' as insurance_type_name,\n        extract (YEAR from formatted_date) as plan_year\nfrom staging_shop_medical\n\n\n\n  limit 100\n\n", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_shop_medical`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.610770Z", "completed_at": "2025-04-20T00:20:22.623675Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.627277Z", "completed_at": "2025-04-20T00:20:22.627277Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.030642986297607422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.dim_market_type", "compiled": true, "compiled_code": "\n\nwith staging_market_type as (\n    select distinct market_coverage_type from `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_plan_attributes`\n)\n\nselect \n    to_hex(md5(cast(coalesce(cast(staging_market_type.market_coverage_type as string), '_dbt_utils_surrogate_key_null_') as string))) as market_type_id,\n    market_coverage_type as market_type_name\nfrom staging_market_type", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_market_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.619343Z", "completed_at": "2025-04-20T00:20:22.628429Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.632437Z", "completed_at": "2025-04-20T00:20:22.632437Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030313968658447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.dim_metal_level", "compiled": true, "compiled_code": "\n\nwith staging_plan_attributes as (\n    select distinct metal_level from `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_plan_attributes`\n)\n\nselect\n    to_hex(md5(cast(coalesce(cast(staging_plan_attributes.metal_level as string), '_dbt_utils_surrogate_key_null_') as string)))  as metal_level_id, \n    metal_level,\n    case \n        when lower(metal_level) = 'bronze' then 1\n        when lower(metal_level) = 'silver' then 2\n        when lower(metal_level) = 'gold' then 3\n        when lower(metal_level) = 'platinum' then 4\n        when lower(metal_level) = 'catastrophic' then 5\n        else 0 end as metal_level_rank -- Assign rank based on metal level for ordering purposes\n    \nfrom staging_plan_attributes", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_metal_level`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.634523Z", "completed_at": "2025-04-20T00:20:22.647124Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.648715Z", "completed_at": "2025-04-20T00:20:22.648715Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.029947519302368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.dim_plan_year", "compiled": true, "compiled_code": "\n\nwith staging_plan_year as (\n    select \n        distinct business_year\n    from \n        `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_plan_attributes`\n)\n\nselect \n    to_hex(md5(cast(coalesce(cast(staging_plan_year.business_year as string), '_dbt_utils_surrogate_key_null_') as string))) as plan_year_id,\n    business_year as plan_year,\n    DATE(business_year, 1, 1) as plan_year_start_date,\n    DATE(business_year, 12, 31) as plan_year_end_date\nfrom \n    staging_plan_year", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_plan_year`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.642213Z", "completed_at": "2025-04-20T00:20:22.655638Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.658231Z", "completed_at": "2025-04-20T00:20:22.658231Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.027800321578979492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.dim_state", "compiled": true, "compiled_code": "\n\nwith stg_states as (\n    select * from `vibrant-mantis-376307`.`insurance_dataset_376307`.`states`\n)\n\nselect to_hex(md5(cast(coalesce(cast(stg_states.State as string), '_dbt_utils_surrogate_key_null_') as string))) as state_id,\nState as state_name,\nAbbreviation as state_abbreviation\nfrom stg_states", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_state`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.649638Z", "completed_at": "2025-04-20T00:20:22.659231Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.661236Z", "completed_at": "2025-04-20T00:20:22.661236Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02411675453186035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.dim_issuer", "compiled": true, "compiled_code": "\n\nwith staging_combined AS (\n    SELECT issuer_name, hios_issuer_id FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_individual_dental`\n    UNION ALL\n    SELECT issuer_name, hios_issuer_id FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_individual_medical`\n    UNION ALL\n    SELECT issuer_name, hios_issuer_id FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_shop_medical`\n    UNION ALL\n    SELECT issuer_name, hios_issuer_id FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_shop_dental`\n)\n\nSELECT DISTINCT\n    to_hex(md5(cast(coalesce(cast(sc.hios_issuer_id as string), '_dbt_utils_surrogate_key_null_') as string))) AS issuer_id,\n    sc.issuer_name,\n    sc.hios_issuer_id\nFROM staging_combined sc", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_issuer`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.667232Z", "completed_at": "2025-04-20T00:20:22.673531Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.673531Z", "completed_at": "2025-04-20T00:20:22.673531Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011209487915039062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.dim_county", "compiled": true, "compiled_code": "\n\n\nwith staging_combined AS (\n    SELECT county_name, fips_county_code, state_code FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_individual_dental`\n    UNION ALL\n    SELECT county_name, fips_county_code, state_code FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_individual_medical`\n    UNION ALL\n    SELECT county_name, fips_county_code, state_code FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_shop_medical`\n    UNION ALL\n    SELECT county_name, fips_county_code, state_code FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_shop_dental`\n),\nstaging_states as (\n    select state_id, state_abbreviation from `vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_state`  -- Ensure dim_state is referenced to get state_id and abbreviation for join\n)\nSELECT DISTINCT\n    to_hex(md5(cast(coalesce(cast(sc.fips_county_code as string), '_dbt_utils_surrogate_key_null_') as string))) AS county_id,\n    ds.state_id,\n    sc.county_name,\n    sc.fips_county_code\nFROM staging_combined sc\nJOIN staging_states ds\n    ON sc.state_code = ds.state_abbreviation\n\n\n\n  limit 100\n\n", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_county`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-20T00:20:22.678163Z", "completed_at": "2025-04-20T00:20:22.686248Z"}, {"name": "execute", "started_at": "2025-04-20T00:20:22.686248Z", "completed_at": "2025-04-20T00:20:22.686248Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011467695236206055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.insurance_marketplace.fact_insurance_plans", "compiled": true, "compiled_code": "\n\nwith staging_individual_dental AS (\n    SELECT state_code,\n    fips_county_code,\n    hios_issuer_id,\n    plan_id_standard_component,\n    plan_marketing_name, \n    metal_level,\n    child_only_plan, \n    premium_child_age_fourteen,\n    premium_child_age_eighteen,\n    premium_adult_individual_age_twenty_one,\n    premium_adult_individual_age_twenty_seven,\n    premium_adult_individual_age_thirty,\n    premium_adult_individual_age_forty,\n    premium_adult_individual_age_fifty,\n    premium_adult_individual_age_sixty,\n    premium_couple_twenty_one,\n    premium_couple_thirty,\n    premium_couple_forty,\n    premium_couple_fifty,\n    premium_couple_sixty,\n    couple_one_child_age_twenty_one,\n    couple_one_child_age_thirty,\n    couple_one_child_age_forty,\n    couple_one_child_age_fifty,\n    couple_two_children_age_twenty_one,\n    couple_two_children_age_thirty,\n    couple_two_children_age_forty,\n    couple_two_children_age_fifty,\n    market_type_name,\n    insurance_type_name,\n    plan_year FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_individual_dental`\n),\nstaging_individual_medical AS (\n    SELECT state_code,\n    fips_county_code,\n    hios_issuer_id,\n    plan_id_standard_component,\n    plan_marketing_name,\n    metal_level,\n    child_only_plan, \n    premium_child_age_fourteen,\n    premium_child_age_eighteen,\n    premium_adult_individual_age_twenty_one,\n    premium_adult_individual_age_twenty_seven,\n    premium_adult_individual_age_thirty,\n    premium_adult_individual_age_forty,\n    premium_adult_individual_age_fifty,\n    premium_adult_individual_age_sixty,\n    premium_couple_twenty_one,\n    premium_couple_thirty,\n    premium_couple_forty,\n    premium_couple_fifty,\n    premium_couple_sixty,\n    couple_one_child_age_twenty_one,\n    couple_one_child_age_thirty,\n    couple_one_child_age_forty,\n    couple_one_child_age_fifty,\n    couple_two_children_age_twenty_one,\n    couple_two_children_age_thirty,\n    couple_two_children_age_forty,\n    couple_two_children_age_fifty,\n    market_type_name,\n    insurance_type_name,\n    plan_year  FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_individual_medical`\n), \nstaging_shop_medical AS (\n    SELECT state_code,\n    fips_county_code,\n    hios_issuer_id,\n    plan_id_standard_component,\n    plan_marketing_name,\n    metal_level,\n    child_only_plan, \n    premium_child_age_fourteen,\n    premium_child_age_eighteen,\n    premium_adult_individual_age_twenty_one,\n    premium_adult_individual_age_twenty_seven,\n    premium_adult_individual_age_thirty,\n    premium_adult_individual_age_forty,\n    premium_adult_individual_age_fifty,\n    premium_adult_individual_age_sixty,\n    premium_couple_twenty_one,\n    premium_couple_thirty,\n    premium_couple_forty,\n    premium_couple_fifty,\n    premium_couple_sixty,\n    couple_one_child_age_twenty_one,\n    couple_one_child_age_thirty,\n    couple_one_child_age_forty,\n    couple_one_child_age_fifty,\n    couple_two_children_age_twenty_one,\n    couple_two_children_age_thirty,\n    couple_two_children_age_forty,\n    couple_two_children_age_fifty,\n    market_type_name,\n    insurance_type_name,\n    plan_year FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_shop_medical`\n),\nstaging_shop_dental AS (\n    SELECT state_code,\n    fips_county_code,\n    hios_issuer_id,\n    plan_id_standard_component,\n    plan_marketing_name, \n    metal_level,\n    child_only_plan, \n    premium_child_age_fourteen,\n    premium_child_age_eighteen,\n    premium_adult_individual_age_twenty_one,\n    premium_adult_individual_age_twenty_seven,\n    premium_adult_individual_age_thirty,\n    premium_adult_individual_age_forty,\n    premium_adult_individual_age_fifty,\n    premium_adult_individual_age_sixty,\n    premium_couple_twenty_one,\n    premium_couple_thirty,\n    premium_couple_forty,\n    premium_couple_fifty,\n    premium_couple_sixty,\n    couple_one_child_age_twenty_one,\n    couple_one_child_age_thirty,\n    couple_one_child_age_forty,\n    couple_one_child_age_fifty,\n    couple_two_children_age_twenty_one,\n    couple_two_children_age_thirty,\n    couple_two_children_age_forty,\n    couple_two_children_age_fifty,\n    market_type_name,\n    insurance_type_name,\n    plan_year FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`stg_shop_dental`\n),\nstaging_states AS (\n    SELECT state_id, state_abbreviation   FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_state`\n),\nstaging_counties AS (\n    SELECT county_id, state_id, fips_county_code FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_county`\n),\nstaging_metal_levels AS (\n    SELECT metal_level_id, metal_level as metal_level_name FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_metal_level`\n),\nstaging_issuer as (\n    SELECT issuer_id, hios_issuer_id FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_issuer`\n),\nstaging_plan_year AS (\n    SELECT plan_year_id, plan_year FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_plan_year`\n),\nstaging_market_types AS (\n    SELECT market_type_id, market_type_name FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_market_type`\n),\nstaging_insurance_types AS (\n    SELECT insurance_type_id, insurance_type FROM `vibrant-mantis-376307`.`insurance_dataset_376307`.`dim_insurance_type`\n),\nstaging_combined AS (\n    SELECT * FROM staging_individual_dental\n    UNION ALL\n    SELECT * FROM staging_individual_medical\n    UNION ALL\n    SELECT *FROM staging_shop_medical\n    UNION ALL\n    SELECT * FROM staging_shop_dental\n)\n\nselect \n    to_hex(md5(cast(coalesce(cast(staging_combined.plan_id_standard_component as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(staging_combined.plan_marketing_name as string), '_dbt_utils_surrogate_key_null_') as string))) as plan_id, -- Surrogate key\n    staging_states.state_id,\n    staging_counties.county_id,\n    staging_metal_levels.metal_level_id,\n    staging_issuer.issuer_id,\n    staging_plan_year.plan_year_id,\n    staging_market_types.market_type_id,\n    staging_insurance_types.insurance_type_id,\n    staging_combined.plan_id_standard_component,\n    staging_combined.plan_marketing_name,\n    staging_combined.child_only_plan,\n    staging_combined.premium_child_age_fourteen,\n    staging_combined.premium_child_age_eighteen,\n    staging_combined.premium_adult_individual_age_twenty_one,\n    staging_combined.premium_adult_individual_age_twenty_seven,\n    staging_combined.premium_adult_individual_age_thirty,\n    staging_combined.premium_adult_individual_age_forty,\n    staging_combined.premium_adult_individual_age_fifty,\n    staging_combined.premium_adult_individual_age_sixty,\n    staging_combined.premium_couple_twenty_one,\n    staging_combined.premium_couple_thirty,\n    staging_combined.premium_couple_forty,\n    staging_combined.premium_couple_fifty,\n    staging_combined.premium_couple_sixty,\n    staging_combined.couple_one_child_age_twenty_one,\n    staging_combined.couple_one_child_age_thirty,\n    staging_combined.couple_one_child_age_forty,\n    staging_combined.couple_one_child_age_fifty,\n    staging_combined.couple_two_children_age_twenty_one,\n    staging_combined.couple_two_children_age_thirty,\n    staging_combined.couple_two_children_age_forty,\n    staging_combined.couple_two_children_age_fifty\nfrom \n    staging_combined\ninner join \n    staging_states on staging_combined.state_code = staging_states.state_abbreviation\ninner join \n    staging_counties on staging_combined.fips_county_code = staging_counties.fips_county_code\ninner join\n    staging_metal_levels on staging_combined.metal_level = staging_metal_levels.metal_level_name\ninner join\n    staging_plan_year on staging_combined.plan_year = staging_plan_year.plan_year\ninner join\n    staging_market_types on staging_combined.market_type_name = staging_market_types.market_type_name\ninner join\n    staging_insurance_types on staging_combined.insurance_type_name = staging_insurance_types.insurance_type\ninner join\n    staging_issuer on staging_combined.hios_issuer_id = staging_issuer.hios_issuer_id\n\n\n  limit 100\n\n", "relation_name": "`vibrant-mantis-376307`.`insurance_dataset_376307`.`fact_insurance_plans`", "batch_results": null}], "elapsed_time": 0.7369389533996582, "args": {"log_level": "info", "exclude": [], "log_format_file": "debug", "source_freshness_run_project_hooks": false, "partial_parse": true, "require_nested_cumulative_type_params": false, "state_modified_compare_more_unrendered_values": false, "macro_debugging": false, "populate_cache": true, "project_dir": "C:\\Users\\fahmi\\projects\\dataeng-zoomcamp-final-project\\dbt\\insurance-marketplace-dbt", "require_yaml_configuration_for_mf_time_spines": false, "static_parser": true, "compile": true, "use_colors": true, "write_json": true, "require_resource_names_without_spaces": false, "strict_mode": false, "favor_state": false, "print": true, "show_resource_report": false, "introspect": true, "select": [], "static": false, "use_colors_file": true, "profiles_dir": "C:\\Users\\fahmi\\.dbt", "cache_selected_only": false, "require_batched_execution_for_custom_microbatch_strategy": false, "log_file_max_bytes": 10485760, "printer_width": 80, "version_check": true, "vars": {}, "quiet": false, "which": "generate", "state_modified_compare_vars": false, "invocation_command": "dbt docs generate", "log_path": "C:\\Users\\fahmi\\projects\\dataeng-zoomcamp-final-project\\dbt\\insurance-marketplace-dbt\\logs", "partial_parse_file_diff": true, "empty_catalog": false, "indirect_selection": "eager", "skip_nodes_if_on_run_start_fails": false, "defer": false, "send_anonymous_usage_stats": true, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug"}}